<!DOCTYPE HTML>
<html lang="">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="多线程（十九）, ljs&#39;s blog">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>多线程（十九） | ljs&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.3.0"></head>


<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/fireworks.js"></script>
<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">ljs&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>档案室</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于我</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">ljs&#39;s blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			档案室
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于我
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/th-gs/th-gs.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/th-gs/th-gs.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">多线程（十九）</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/JAVA/">
                                <span class="chip bg-color">JAVA</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/notes/" class="post-category">
                                notes
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2023-04-06
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    6.6k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="多线程（十九）"><a href="#多线程（十九）" class="headerlink" title="多线程（十九）"></a>多线程（十九）</h1><p><strong>进程</strong>：进程是程序的基本执行实体。  </p>
<p><strong>线程</strong>：线程是操作系统能够进行运算调度的最小单位，它被包含在进程之中，是进程中实际运作单位，简单理解为在应用软件中互相独立，可以同时运行的功能。  </p>
<p>有了<strong>多线程</strong>，可让程序同时做多件事情，<strong>多线程</strong>可以提高效率，若想让多个事情同时运行就需要用到多线程，比如：软件中的耗时操作，所有的聊天软件，所有的服务器。  </p>
<p><strong>并发</strong>：在同一时刻，有多个指令在单个CPU上交替执行。  </p>
<p><strong>并行</strong>：在同一时刻，有多个指令在单个CPU上同时执行。  </p>
<p><strong>线程的调度</strong></p>
<ol>
<li><strong>抢占式调度</strong>：指优先让可运行池中优先级高的线程占用CPU，优先级并不绝对，只不过优先级越高，占用CPU的概率越高。</li>
<li><strong>分时调度</strong>：又称非抢占式调度，指让所有线程轮流获得cpu的使用权。</li>
</ol>
<h2 id="多线程的实现方式"><a href="#多线程的实现方式" class="headerlink" title="多线程的实现方式"></a>多线程的实现方式</h2><p>线程是程序中的执行线程，java虚拟机允许应用程序并发地运行多个执行线程。</p>
<ol>
<li>继承Thread类的方式进行实现</li>
<li>实现Runnable接口的方式进行实现</li>
<li>利用Callable接口和Future接口方式实现</li>
</ol>
<h3 id="继承Thread类"><a href="#继承Thread类" class="headerlink" title="继承Thread类"></a>继承Thread类</h3><p><strong>步骤</strong>：</p>
<ol>
<li>定义一个类继承Thread</li>
<li>重写run方法</li>
<li>创建子类对象，并启动线程（利用start方法启动，run方法会自动调用）</li>
</ol>
<p><strong>范例</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Function f1&#x3D;new Function();</span><br><span class="line">        Function f2&#x3D;new Function();</span><br><span class="line">        f1.setName(&quot;线程1&quot;);</span><br><span class="line">        f2.setName(&quot;线程2&quot;);</span><br><span class="line">        f1.start();</span><br><span class="line">        f2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Function.java</span><br><span class="line">public class Function extends Thread &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">            System.out.println(getName()+&quot;执行&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程1执行</span><br><span class="line">线程2执行</span><br><span class="line">线程1执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="实现Runnable接口"><a href="#实现Runnable接口" class="headerlink" title="实现Runnable接口"></a>实现Runnable接口</h3><p><strong>步骤</strong>：</p>
<ol>
<li>定义一个类实现Runnable接口</li>
<li>重写里面的run方法</li>
<li>创建自己类的对象</li>
<li>创建一个Thread类的对象，并开启线程</li>
</ol>
<p><strong>范例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F;创建function对象，表示多线程要执行的任务</span><br><span class="line">        Function f&#x3D;new Function();</span><br><span class="line">        &#x2F;&#x2F;创建线程对象</span><br><span class="line">        Thread t1&#x3D;new Thread(f);</span><br><span class="line">        Thread t2&#x3D;new Thread(f);</span><br><span class="line">        &#x2F;&#x2F;给线程设置名字</span><br><span class="line">        t1.setName(&quot;线程1&quot;);</span><br><span class="line">        t2.setName(&quot;线程2&quot;);</span><br><span class="line">        &#x2F;&#x2F;开启线程</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Function.java</span><br><span class="line">public class Function implements Runnable &#123;</span><br><span class="line">    &#x2F;&#x2F;线程要执行的代码</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        &#x2F;&#x2F;获取当前线程的对象</span><br><span class="line">        Thread t&#x3D;Thread.currentThread();</span><br><span class="line">        for (int i&#x3D;0;i&lt;10;i++) &#123;</span><br><span class="line">            System.out.println(t.getName()+&quot;执行&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程2执行</span><br><span class="line">线程1执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程2执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">线程1执行</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="Callable接口和Future接口方式实现"><a href="#Callable接口和Future接口方式实现" class="headerlink" title="Callable接口和Future接口方式实现"></a>Callable接口和Future接口方式实现</h3><p><strong>特点</strong>：可获取多线程运行的结果  </p>
<p><strong>步骤</strong>：</p>
<ol>
<li>创建一个类MyCallable类实现Callable接口，其中泛型便是多线程运行的结果类型</li>
<li>重写Call方法（具有返回值，表示多线程运行的结果）</li>
<li>创建MyCallable的对象（表示多线程要执行的任务）</li>
<li>创建FutureTask的对象（作用为管理多线程运行的结果）</li>
<li>创建Thread对象，并启动（表示线程）</li>
</ol>
<p><strong>范例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;MyCallable.java</span><br><span class="line"></span><br><span class="line">import java.util.concurrent.Callable;</span><br><span class="line"></span><br><span class="line">public class MyCallable implements Callable&lt;Integer&gt; &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Integer call() throws Exception &#123;</span><br><span class="line">        int sum&#x3D;0;</span><br><span class="line">        for(int i&#x3D;1;i&lt;&#x3D;100;i++)&#123;</span><br><span class="line">            sum+&#x3D;i;</span><br><span class="line">        &#125;</span><br><span class="line">        return sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">import java.util.concurrent.ExecutionException;</span><br><span class="line">import java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws ExecutionException, InterruptedException &#123;</span><br><span class="line">        &#x2F;&#x2F;创建一个类MyCallable实现Callable接口</span><br><span class="line">        MyCallable mc&#x3D;new MyCallable();</span><br><span class="line">        &#x2F;&#x2F;创建FutureTask的对象（作用为管理多线程运行的结果）</span><br><span class="line">        FutureTask&lt;Integer&gt; ft&#x3D;new FutureTask&lt;&gt;(mc);</span><br><span class="line">        &#x2F;&#x2F;创建线程的对象</span><br><span class="line">        Thread t&#x3D;new Thread(ft);</span><br><span class="line">        &#x2F;&#x2F;启动线程</span><br><span class="line">        t.start();</span><br><span class="line">        &#x2F;&#x2F;获取多线程运行的结果</span><br><span class="line">        Integer integer &#x3D; ft.get();</span><br><span class="line">        System.out.println(integer);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">5050</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="三种方式对比"><a href="#三种方式对比" class="headerlink" title="三种方式对比"></a>三种方式对比</h3><ul>
<li><p>继承Thread类</p>
<ul>
<li><strong>优点</strong>：编程比较简单，可直接使用Thread类的方法</li>
<li><strong>缺点</strong>：可扩展性差，不能再继承其他类</li>
</ul>
</li>
<li><p>实现Runnable接口</p>
<ul>
<li><strong>优点</strong>：扩展性强，实现该接口的同时还可以继承其他类</li>
<li><strong>缺点</strong>：编程相对复杂，不能直接使用Thread类中的方法</li>
</ul>
</li>
<li><p>实现Callable接口</p>
<ul>
<li><strong>优点</strong>：扩展性强，实现该接口的同时还可以继承其他类，可获取多线程运行的结果 </li>
<li><strong>缺点</strong>：编程相对复杂，不能直接使用Thread类中的方法</li>
</ul>
</li>
</ul>
<h2 id="常见成员方法"><a href="#常见成员方法" class="headerlink" title="常见成员方法"></a>常见成员方法</h2><h3 id="getName"><a href="#getName" class="headerlink" title="getName"></a>getName</h3><p>String getName()  </p>
<p><strong>说明</strong>：返回此线程的名称，若没有给线程设置名字，线程也是有默认名字的，默认名字格式：Thread-X（X序号，从0开始）</p>
<h3 id="setName"><a href="#setName" class="headerlink" title="setName"></a>setName</h3><p>void setName(String name)  </p>
<p><strong>说明</strong>：设置线程名字（构造方法也可以设置名字）</p>
<h3 id="currentThread"><a href="#currentThread" class="headerlink" title="currentThread"></a>currentThread</h3><p>static Thread currentThread()  </p>
<p><strong>说明</strong>：获取当前线程的对象，当虚拟机启动后，会自动启用多条线程，其中一条叫做main线程，它的作用便是调用main方法，并执行其中代码。</p>
<h3 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h3><p>static void sleep(long time)  </p>
<p><strong>说明</strong>：让线程休眠指定的时间，单位为毫秒（1秒等于1000毫秒），哪条线程执行到这个方法，那么哪条线程就会在这里停留对应的时间。</p>
<h3 id="setPriority"><a href="#setPriority" class="headerlink" title="setPriority"></a>setPriority</h3><p>setPriority(int newPriority)  </p>
<p><strong>说明</strong>：设置线程的优先级，优先级最高位10，最低为1，默认为5</p>
<h3 id="getPriority"><a href="#getPriority" class="headerlink" title="getPriority"></a>getPriority</h3><p>final int getPriority()  </p>
<p><strong>说明</strong>：获取线程的优先级</p>
<h3 id="setDaemon"><a href="#setDaemon" class="headerlink" title="setDaemon"></a>setDaemon</h3><p>final void setDaemon(boolean on)  </p>
<p><strong>说明</strong>：设置守护线程，当其他非守护线程执行完毕后，守护线程会陆续结束。</p>
<h3 id="yield"><a href="#yield" class="headerlink" title="yield"></a>yield</h3><p>public static void yield()  </p>
<p><strong>说明</strong>：出让线程/礼让线程</p>
<h3 id="join"><a href="#join" class="headerlink" title="join"></a>join</h3><p>public final void join()  </p>
<p><strong>说明</strong>：插入线程/插队线程。表示把调用该方法的线程插入到当前线程之前</p>
<h3 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread extends Thread &#123;</span><br><span class="line">    public MyThread() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public MyThread(String name) &#123;</span><br><span class="line">        super(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(5000);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        &#x2F;&#x2F;getName默认</span><br><span class="line">        MyThread mt1&#x3D;new MyThread();</span><br><span class="line">        mt1.start();</span><br><span class="line">        &#x2F;&#x2F;构造方法设置</span><br><span class="line">        MyThread mt2&#x3D;new MyThread(&quot;线程2&quot;);</span><br><span class="line">        mt2.start();</span><br><span class="line">        &#x2F;&#x2F;通过setName设置后的getName</span><br><span class="line">        MyThread mt3&#x3D;new MyThread();</span><br><span class="line">        mt3.setName(&quot;线程3&quot;);</span><br><span class="line">        mt3.start();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;currentThread</span><br><span class="line">        Thread t&#x3D;Thread.currentThread();</span><br><span class="line">        System.out.println(t.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">main</span><br><span class="line">线程2</span><br><span class="line">Thread-0</span><br><span class="line">线程3</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread implements Runnable &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i&#x3D;0;i&lt;10;i++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+&quot;:&quot;+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        MyThread mt&#x3D;new MyThread();</span><br><span class="line">        Thread t1&#x3D;new Thread(mt,&quot;线程1&quot;);</span><br><span class="line">        Thread t2&#x3D;new Thread(mt,&quot;线程2&quot;);</span><br><span class="line">        System.out.println(&quot;默认&quot;);</span><br><span class="line">        System.out.println(t1.getPriority());</span><br><span class="line">        System.out.println(t2.getPriority());</span><br><span class="line">        System.out.println(&quot;修该后&quot;);</span><br><span class="line">        t1.setPriority(1);</span><br><span class="line">        t2.setPriority(10);</span><br><span class="line">        System.out.println(t1.getPriority());</span><br><span class="line">        System.out.println(t2.getPriority());</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">默认</span><br><span class="line">5</span><br><span class="line">5</span><br><span class="line">修该后</span><br><span class="line">1</span><br><span class="line">10</span><br><span class="line">线程2:0</span><br><span class="line">线程2:1</span><br><span class="line">线程1:0</span><br><span class="line">线程2:2</span><br><span class="line">线程1:1</span><br><span class="line">线程1:2</span><br><span class="line">线程2:3</span><br><span class="line">线程1:3</span><br><span class="line">线程2:4</span><br><span class="line">线程1:4</span><br><span class="line">线程2:5</span><br><span class="line">线程2:6</span><br><span class="line">线程2:7</span><br><span class="line">线程2:8</span><br><span class="line">线程2:9</span><br><span class="line">线程1:5</span><br><span class="line">线程1:6</span><br><span class="line">线程1:7</span><br><span class="line">线程1:8</span><br><span class="line">线程1:9</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        MyThread1 mt1&#x3D;new MyThread1();</span><br><span class="line">        MyThread2 mt2&#x3D;new MyThread2();</span><br><span class="line">        mt1.setName(&quot;守护线程&quot;);</span><br><span class="line">        mt2.setName(&quot;非守护线程&quot;);</span><br><span class="line">        mt1.setDaemon(true);</span><br><span class="line">        mt1.start();</span><br><span class="line">        mt2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread1.java</span><br><span class="line">public class MyThread1 extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 100; i++) &#123;</span><br><span class="line">            System.out.println(getName()+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread2.java</span><br><span class="line">public class MyThread2 extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">            System.out.println(getName()+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">守护线程0</span><br><span class="line">非守护线程0</span><br><span class="line">非守护线程1</span><br><span class="line">守护线程1</span><br><span class="line">非守护线程2</span><br><span class="line">守护线程2</span><br><span class="line">非守护线程3</span><br><span class="line">非守护线程4</span><br><span class="line">非守护线程5</span><br><span class="line">非守护线程6</span><br><span class="line">非守护线程7</span><br><span class="line">非守护线程8</span><br><span class="line">非守护线程9</span><br><span class="line">守护线程3</span><br><span class="line">守护线程4</span><br><span class="line">守护线程5</span><br><span class="line">守护线程6</span><br><span class="line">守护线程7</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        MyThread mt1&#x3D;new MyThread();</span><br><span class="line">        MyThread mt2&#x3D;new MyThread();</span><br><span class="line">        mt1.setName(&quot;线程一&quot;);</span><br><span class="line">        mt2.setName(&quot;线程二&quot;);</span><br><span class="line">        mt1.start();</span><br><span class="line">        mt2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">            System.out.println(getName()+i);</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">线程一0</span><br><span class="line">线程二0</span><br><span class="line">线程二1</span><br><span class="line">线程一1</span><br><span class="line">线程一2</span><br><span class="line">线程一3</span><br><span class="line">线程二2</span><br><span class="line">线程一4</span><br><span class="line">线程一5</span><br><span class="line">线程二3</span><br><span class="line">线程二4</span><br><span class="line">线程二5</span><br><span class="line">线程一6</span><br><span class="line">线程二6</span><br><span class="line">线程一7</span><br><span class="line">线程二7</span><br><span class="line">线程一8</span><br><span class="line">线程一9</span><br><span class="line">线程二8</span><br><span class="line">线程二9</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        MyThread mt&#x3D;new MyThread();</span><br><span class="line">        mt.setName(&quot;线程一&quot;);</span><br><span class="line">        mt.start();</span><br><span class="line">        mt.join();</span><br><span class="line"></span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">            System.out.println(&quot;main线程&quot;+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">            System.out.println(getName()+i);</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">线程一0</span><br><span class="line">线程一1</span><br><span class="line">线程一2</span><br><span class="line">线程一3</span><br><span class="line">线程一4</span><br><span class="line">线程一5</span><br><span class="line">线程一6</span><br><span class="line">线程一7</span><br><span class="line">线程一8</span><br><span class="line">线程一9</span><br><span class="line">main线程0</span><br><span class="line">main线程1</span><br><span class="line">main线程2</span><br><span class="line">main线程3</span><br><span class="line">main线程4</span><br><span class="line">main线程5</span><br><span class="line">main线程6</span><br><span class="line">main线程7</span><br><span class="line">main线程8</span><br><span class="line">main线程9</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h2><p><strong>新建状态NEW</strong>：创建线程对象。调用start方法后变成就绪状态  </p>
<p><strong>就绪状态RUNNABLE</strong>：有执行资格，没执行权。不停的抢CPU  </p>
<p><strong>阻塞状态BLOCKED</strong>：无法获得锁对象  </p>
<p><strong>等待状态WAITING</strong>：wait方法</p>
<p><strong>计时状态TIMED_WAITING</strong>：sleep方法</p>
<p><strong>死亡状态TERMINATED</strong>：若run执行完毕，线程死亡，变成垃圾  </p>
<h2 id="同步代码块"><a href="#同步代码块" class="headerlink" title="同步代码块"></a>同步代码块</h2><p>把操作共享数据的代码锁起来。  </p>
<p><strong>特点</strong>：</p>
<ol>
<li>锁默认打开，有一个线程进去，缩自动关闭</li>
<li>里面的代码全部执行完毕，线程出来，缩自动打开</li>
</ol>
<p><strong>格式</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">synchronized(锁)&#123;</span><br><span class="line">	操作共享数据的代码</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;锁对象一定要是唯一的，一般写当前类的字节码文件。</span><br></pre></td></tr></table></figure>
<p><strong>范例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;某电影院目前上映的甲电影，共有10张票，有3个窗口售卖，设计一个程序模拟该电影院买票</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        MyThread mt1&#x3D;new MyThread();</span><br><span class="line">        mt1.setName(&quot;窗口1&quot;);</span><br><span class="line"></span><br><span class="line">        MyThread mt2&#x3D;new MyThread();</span><br><span class="line">        mt2.setName(&quot;窗口2&quot;);</span><br><span class="line"></span><br><span class="line">        MyThread mt3&#x3D;new MyThread();</span><br><span class="line">        mt3.setName(&quot;窗口3&quot;);</span><br><span class="line"></span><br><span class="line">        mt1.start();</span><br><span class="line">        mt2.start();</span><br><span class="line">        mt3.start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    static int ticketNum&#x3D;1;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            synchronized (MyThread.class) &#123;</span><br><span class="line">                if (ticketNum &lt;&#x3D;10) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Thread.sleep(10);</span><br><span class="line">                    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(getName() + &quot;卖出第&quot; + ticketNum + &quot;张票&quot;);</span><br><span class="line">                    ticketNum++;</span><br><span class="line"></span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">窗口1卖出第1张票</span><br><span class="line">窗口1卖出第2张票</span><br><span class="line">窗口3卖出第3张票</span><br><span class="line">窗口3卖出第4张票</span><br><span class="line">窗口3卖出第5张票</span><br><span class="line">窗口3卖出第6张票</span><br><span class="line">窗口3卖出第7张票</span><br><span class="line">窗口3卖出第8张票</span><br><span class="line">窗口2卖出第9张票</span><br><span class="line">窗口2卖出第10张票</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="同步方法"><a href="#同步方法" class="headerlink" title="同步方法"></a>同步方法</h2><p>就是把synchronized关键字加到方法上。  </p>
<p><strong>格式</strong>：  </p>
<p>修饰符 synchronized 返回值类型 方法名(方法参数){…}  </p>
<p><strong>特点</strong>：</p>
<ol>
<li>同步方法是锁住方法里面所有的代码</li>
<li>锁对象不能自己指定。<ul>
<li>非静态方法：this</li>
<li>静态方法：当前类的字节码文件对象</li>
</ul>
</li>
</ol>
<p><strong>范例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;某电影院目前上映的甲电影，共有10张票，有3个窗口售卖，设计一个程序模拟该电影院买票,同步方法实现</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">1public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        MyThread myThread&#x3D;new MyThread();</span><br><span class="line">        Thread t1&#x3D;new Thread(myThread);</span><br><span class="line">        Thread t2&#x3D;new Thread(myThread);</span><br><span class="line">        Thread t3&#x3D;new Thread(myThread);</span><br><span class="line">        t1.setName(&quot;窗口1&quot;);</span><br><span class="line">        t2.setName(&quot;窗口2&quot;);</span><br><span class="line">        t3.setName(&quot;窗口3&quot;);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">public class MyThread implements Runnable&#123;</span><br><span class="line">    int ticketNum&#x3D;0;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            if (method())&#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    private synchronized boolean method()&#123;</span><br><span class="line">        if(ticketNum&#x3D;&#x3D;10)&#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Thread.sleep(10);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            ticketNum++;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+ &quot;卖出第&quot; + ticketNum + &quot;张票&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">窗口1卖出第1张票</span><br><span class="line">窗口1卖出第2张票</span><br><span class="line">窗口1卖出第3张票</span><br><span class="line">窗口1卖出第4张票</span><br><span class="line">窗口1卖出第5张票</span><br><span class="line">窗口1卖出第6张票</span><br><span class="line">窗口1卖出第7张票</span><br><span class="line">窗口1卖出第8张票</span><br><span class="line">窗口3卖出第9张票</span><br><span class="line">窗口2卖出第10张票</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="lock锁"><a href="#lock锁" class="headerlink" title="lock锁"></a>lock锁</h2><p>Lock中提供<strong>获得锁</strong>和<strong>释放锁</strong>的方法。  </p>
<p>void lock(); 获得锁  </p>
<p>void unlock(); 释放锁  </p>
<p>Lock是接口不能直接实例化，这里采用它的实现类ReentrantLock来实例化。  </p>
<p>ReentrantLock的构造方法：  </p>
<p>ReentrantLock(); 创建一个ReentrantLock的实例。  </p>
<p><strong>范例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;某电影院目前上映的甲电影，共有10张票，有3个窗口售卖，设计一个程序模拟该电影院买票,Lock实现</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        MyThread mt1&#x3D;new MyThread();</span><br><span class="line">        mt1.setName(&quot;窗口1&quot;);</span><br><span class="line"></span><br><span class="line">        MyThread mt2&#x3D;new MyThread();</span><br><span class="line">        mt2.setName(&quot;窗口2&quot;);</span><br><span class="line"></span><br><span class="line">        MyThread mt3&#x3D;new MyThread();</span><br><span class="line">        mt3.setName(&quot;窗口3&quot;);</span><br><span class="line"></span><br><span class="line">        mt1.start();</span><br><span class="line">        mt2.start();</span><br><span class="line">        mt3.start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyThread.java</span><br><span class="line">import java.util.concurrent.locks.Lock;</span><br><span class="line">import java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    static int ticketNum&#x3D;1;</span><br><span class="line">    static Lock lock&#x3D;new ReentrantLock();</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            lock.lock();</span><br><span class="line">            try &#123;</span><br><span class="line">                if (ticketNum &lt;&#x3D;100) &#123;</span><br><span class="line">                    Thread.sleep(10);</span><br><span class="line">                    System.out.println(getName() + &quot;卖出第&quot; + ticketNum + &quot;张票&quot;);</span><br><span class="line">                    ticketNum++;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>注</strong>：写锁的时候不要让锁嵌套，否则可能会死锁。  </p>
<h2 id="等待唤醒机制"><a href="#等待唤醒机制" class="headerlink" title="等待唤醒机制"></a>等待唤醒机制</h2><h3 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h3><p><strong>等待唤醒机制</strong>(生产者消费者模式)是多个线程之间的一种协作机制。  </p>
<p><strong>思路</strong>:  </p>
<p>此处将消费者比喻成吃货，生产者比喻成厨师。</p>
<ul>
<li><strong>消费者</strong>：消费数据<ol>
<li>判断桌子上是否有食物</li>
<li>若无，等待</li>
<li>若有，开吃</li>
<li>吃完后，唤醒厨师继续做</li>
</ol>
</li>
<li><strong>生产者</strong>：生产数据<ol>
<li>判断桌子上是否有食物</li>
<li>若有，等待</li>
<li>若无，做饭</li>
<li>把食物放到桌子上</li>
<li>唤醒等待的消费者开吃</li>
</ol>
</li>
</ul>
<h4 id="常见方法"><a href="#常见方法" class="headerlink" title="常见方法"></a>常见方法</h4><h5 id="wait"><a href="#wait" class="headerlink" title="wait"></a>wait</h5><p>void wait()  </p>
<p><strong>说明</strong>：当前线程等待，直到被其他线程唤醒</p>
<h5 id="notify"><a href="#notify" class="headerlink" title="notify"></a>notify</h5><p>void notify()  </p>
<p><strong>说明</strong>：随机唤醒单个线程</p>
<h5 id="notifyAll"><a href="#notifyAll" class="headerlink" title="notifyAll"></a>notifyAll</h5><p>void notifyAll()  </p>
<p><strong>说明</strong>：唤醒所有线程</p>
<h4 id="范例-1"><a href="#范例-1" class="headerlink" title="范例"></a>范例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Desk.java</span><br><span class="line">public class Desk &#123;</span><br><span class="line">    public static int count&#x3D;10;&#x2F;&#x2F;吃货能吃的饭的数量</span><br><span class="line">    public static Object lock&#x3D;new Object();&#x2F;&#x2F;锁</span><br><span class="line">    public static int state&#x3D;0;&#x2F;&#x2F;桌子的状态，若无食物为0，若有食物为1</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Cookie.java</span><br><span class="line">public class Cookie extends Thread &#123;</span><br><span class="line">    &#x2F;*</span><br><span class="line">    1. 循环</span><br><span class="line">    2.同步代码块</span><br><span class="line">    3.判断共享数据是否到了尽头（到了尽头）</span><br><span class="line">    4.判断共享数据是否到了尽头（没到尽头，执行核心逻辑）</span><br><span class="line">    *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while(true)&#123;</span><br><span class="line">            synchronized (Desk.lock)&#123;</span><br><span class="line">                if(Desk.count&#x3D;&#x3D;0)&#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;else &#123;&#x2F;&#x2F;判断桌子上是否有食物</span><br><span class="line">                    if(Desk.state&#x3D;&#x3D;0)&#123;&#x2F;&#x2F;无食物，厨师做饭</span><br><span class="line">                        System.out.println(&quot;厨师做饭&quot;);</span><br><span class="line">                        &#x2F;&#x2F;桌子上有了食物，状态设为1</span><br><span class="line">                        Desk.state&#x3D;1;</span><br><span class="line">                        &#x2F;&#x2F;唤醒吃货</span><br><span class="line">                        Desk.lock.notifyAll();</span><br><span class="line">                    &#125;else&#123;&#x2F;&#x2F;若有，则等待</span><br><span class="line">                        try &#123;</span><br><span class="line">                            Desk.lock.wait();</span><br><span class="line">                        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Foodie.java</span><br><span class="line">public class Foodie extends Thread&#123;</span><br><span class="line">    &#x2F;*</span><br><span class="line">    1. 循环</span><br><span class="line">    2.同步代码块</span><br><span class="line">    3.判断共享数据是否到了尽头（到了尽头）</span><br><span class="line">    4.判断共享数据是否到了尽头（没到尽头，执行核心逻辑）</span><br><span class="line">    *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            synchronized (Desk.lock)&#123;</span><br><span class="line">                if (Desk.count&#x3D;&#x3D;0)&#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    &#x2F;&#x2F;判断桌子是否有食物</span><br><span class="line">                    if(Desk.state&#x3D;&#x3D;0)&#123;</span><br><span class="line">                        try &#123;&#x2F;&#x2F;若无，等待</span><br><span class="line">                            Desk.lock.wait();</span><br><span class="line">                        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;else&#123;&#x2F;&#x2F;若有，开吃</span><br><span class="line">                        &#x2F;&#x2F;先将饭量-1</span><br><span class="line">                        Desk.count--;</span><br><span class="line">                        System.out.println(&quot;吃货还能吃&quot;+Desk.count+&quot;顿饭&quot;);</span><br><span class="line">                        &#x2F;&#x2F;吃饭后，桌子上没有事物，状态设为0</span><br><span class="line">                        Desk.state&#x3D;0;</span><br><span class="line">                        &#x2F;&#x2F;唤醒厨师</span><br><span class="line">                        Desk.lock.notifyAll();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Cookie cookie&#x3D;new Cookie();</span><br><span class="line">        Foodie foodie&#x3D;new Foodie();</span><br><span class="line">        cookie.start();</span><br><span class="line">        foodie.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃9顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃8顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃7顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃6顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃5顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃4顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃3顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃2顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃1顿饭</span><br><span class="line">厨师做饭</span><br><span class="line">吃货还能吃0顿饭</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><p>阻塞队列实现等待唤醒机制。  </p>
<h4 id="阻塞队列继承结构"><a href="#阻塞队列继承结构" class="headerlink" title="阻塞队列继承结构"></a>阻塞队列继承结构</h4><p>阻塞队列实现Iterable,Collection,Queue,BlockingQueue接口，有两个实现类:</p>
<ol>
<li><strong>ArrayBlockingQueue</strong>：底层是数组，有界</li>
<li><strong>LinkedBlockingQueue</strong>：底层是链表，无界，但不是真的无界，最大为int最大值</li>
</ol>
<p><strong>思路</strong>：</p>
<p>此处将消费者比喻成吃货，生产者比喻成厨师。</p>
<ul>
<li>厨师<ol>
<li>构造方法中接收一个阻塞队列对象</li>
<li>run方法中循环向阻塞队列添加食物</li>
<li>打印添加结果</li>
</ol>
</li>
<li>吃货<ol>
<li>构造方法中接收一个阻塞队列对象</li>
<li>run方法中循环获取阻塞队列的食物</li>
<li>打印获取结果</li>
</ol>
</li>
</ul>
<h4 id="核心方法"><a href="#核心方法" class="headerlink" title="核心方法"></a>核心方法</h4><p>put(anObject)  </p>
<p>将参数放入队列，若放不进去会堵塞。  </p>
<p>take()  </p>
<p>取出第一个数据，取不到会堵塞。  </p>
<p><strong>注</strong>：put，take方法里本身就有锁</p>
<h4 id="范例-2"><a href="#范例-2" class="headerlink" title="范例"></a>范例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">import java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        ArrayBlockingQueue&lt;String&gt; abq&#x3D;new ArrayBlockingQueue&lt;&gt;(1);&#x2F;&#x2F;创建阻塞对象，并设置容量</span><br><span class="line">        Cookie cookie&#x3D;new Cookie(abq);</span><br><span class="line">        Foodie foodie&#x3D;new Foodie(abq);</span><br><span class="line">        cookie.start();</span><br><span class="line">        foodie.start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Cookie.java</span><br><span class="line">import java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"></span><br><span class="line">public class Cookie extends Thread&#123;</span><br><span class="line">    ArrayBlockingQueue&lt;String&gt; abq;</span><br><span class="line">    public Cookie(ArrayBlockingQueue&lt;String&gt; abq)&#123;</span><br><span class="line">        this.abq&#x3D;abq;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                abq.put(&quot;食物&quot;);</span><br><span class="line">                System.out.println(&quot;厨师放食物&quot;);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Foodie.java</span><br><span class="line">import java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"></span><br><span class="line">public class Foodie extends Thread&#123;</span><br><span class="line">    ArrayBlockingQueue&lt;String&gt; abq;</span><br><span class="line">    public Foodie(ArrayBlockingQueue&lt;String&gt; abq)&#123;</span><br><span class="line">        this.abq&#x3D;abq;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                String s&#x3D;abq.take();</span><br><span class="line">                System.out.println(s);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><h3 id="例1"><a href="#例1" class="headerlink" title="例1"></a>例1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">假设：100元分成了三个红包（均为整数），有5人去抢</span><br><span class="line">其中红包是共享数据。</span><br><span class="line">5个人5条线程</span><br><span class="line">打印结果如下：</span><br><span class="line">XXX抢到了XX元</span><br><span class="line">XXX抢到了XX元</span><br><span class="line">XXX抢到了XX元</span><br><span class="line">XXX没抢到</span><br><span class="line">XXX没抢到</span><br><span class="line">*&#x2F;</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        RedPackage rp1&#x3D;new RedPackage();</span><br><span class="line">        RedPackage rp2&#x3D;new RedPackage();</span><br><span class="line">        RedPackage rp3&#x3D;new RedPackage();</span><br><span class="line">        RedPackage rp4&#x3D;new RedPackage();</span><br><span class="line">        RedPackage rp5&#x3D;new RedPackage();</span><br><span class="line"></span><br><span class="line">        rp1.setName(&quot;线程1&quot;);</span><br><span class="line">        rp2.setName(&quot;线程2&quot;);</span><br><span class="line">        rp3.setName(&quot;线程3&quot;);</span><br><span class="line">        rp4.setName(&quot;线程4&quot;);</span><br><span class="line">        rp5.setName(&quot;线程5&quot;);</span><br><span class="line"></span><br><span class="line">        rp1.start();</span><br><span class="line">        rp2.start();</span><br><span class="line">        rp3.start();</span><br><span class="line">        rp4.start();</span><br><span class="line">        rp5.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;RedPackage.java</span><br><span class="line">import java.util.Random;</span><br><span class="line"></span><br><span class="line">public class RedPackage extends Thread&#123;</span><br><span class="line">    static int sum&#x3D;100;</span><br><span class="line">    static int count&#x3D;3;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        synchronized (RedPackage.class)&#123;</span><br><span class="line">            if(count&#x3D;&#x3D;0)&#123;</span><br><span class="line">                System.out.println(getName()+&quot;没抢到&quot;);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                if(count&#x3D;&#x3D;1)&#123;</span><br><span class="line">                    int money&#x3D;sum;</span><br><span class="line">                    System.out.println(getName()+&quot;抢到了&quot;+money+&quot;元&quot;);</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    Random r&#x3D;new Random();</span><br><span class="line">                    int money&#x3D;r.nextInt(sum-(count-1))+1;</span><br><span class="line">                    System.out.println(getName()+&quot;抢到了&quot;+money+&quot;元&quot;);</span><br><span class="line">                    sum&#x3D;sum-money;</span><br><span class="line">                &#125;</span><br><span class="line">                count--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">线程1抢到了3元</span><br><span class="line">线程5抢到了40元</span><br><span class="line">线程4抢到了57元</span><br><span class="line">线程3没抢到</span><br><span class="line">线程2没抢到</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="例2"><a href="#例2" class="headerlink" title="例2"></a>例2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">有一个抽奖池，该抽奖池中存放了奖励的金额，该抽奖池中的奖项为10,5,20,50,100,200,500,800,2,80,300,700</span><br><span class="line">创建两个抽奖箱（线程）设置线程名分别为“抽奖箱1”和“抽奖箱2”</span><br><span class="line">随机从抽奖池中获取奖项元素并打印在控制台上，格式如下：</span><br><span class="line">在此次抽奖过程中，抽奖箱2共产生6个奖项</span><br><span class="line">分别为:800,10,80,500,700,2最高奖项为800元，总计额为2092元</span><br><span class="line">在此次抽奖过程中，抽奖箱1共产生6个奖项</span><br><span class="line">分别为:5,100,50,300,20,200最高奖项为300元，总计额为675元</span><br><span class="line">在此次抽奖过程中，抽奖箱2中产生最大奖项，该奖项金额为800元</span><br><span class="line">*&#x2F;</span><br><span class="line">&#x2F;&#x2F;Lottery.java</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Collections;</span><br><span class="line">import java.util.concurrent.Callable;</span><br><span class="line"></span><br><span class="line">public class Lottery implements Callable&lt;Integer&gt; &#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; moneyBox;</span><br><span class="line">    public Lottery(ArrayList&lt;Integer&gt; moneyBox)&#123;</span><br><span class="line">        this.moneyBox&#x3D;moneyBox;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public Integer call() throws Exception &#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; list&#x3D;new ArrayList&lt;&gt;();</span><br><span class="line">        int sum&#x3D;0;</span><br><span class="line">        while (true)&#123;</span><br><span class="line">            synchronized (Lottery.class) &#123;</span><br><span class="line">                if (moneyBox.size() &#x3D;&#x3D; 0) &#123;</span><br><span class="line">                    print(list,Collections.max(list),sum);</span><br><span class="line">                    break;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    Collections.shuffle(moneyBox);</span><br><span class="line">                    int money &#x3D; moneyBox.remove(0);</span><br><span class="line">                    list.add(money);</span><br><span class="line">                    sum+&#x3D;money;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Thread.sleep(10);</span><br><span class="line">        &#125;</span><br><span class="line">        if(list.size()&#x3D;&#x3D;0)&#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        return Collections.max(list);</span><br><span class="line">    &#125;</span><br><span class="line">    private static void print(ArrayList&lt;Integer&gt; list,int max,int sum)&#123;</span><br><span class="line">        System.out.println(&quot;在此次抽奖过程中，&quot;+Thread.currentThread().getName()+&quot;共产生&quot;+list.size()+&quot;个奖项&quot;);</span><br><span class="line">        System.out.print(&quot;分别为:&quot;);</span><br><span class="line">        for(int i&#x3D;0;i&lt;list.size();i++)&#123;</span><br><span class="line">            System.out.print(list.get(i));</span><br><span class="line">            if(i&lt; list.size()-1)&#123;</span><br><span class="line">                System.out.print(&quot;,&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;最高奖项为&quot;+max+&quot;元，总计额为&quot;+sum+&quot;元&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Collections;</span><br><span class="line">import java.util.concurrent.ExecutionException;</span><br><span class="line">import java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws ExecutionException, InterruptedException &#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; moneyBox&#x3D;new ArrayList&lt;&gt;();</span><br><span class="line">        Collections.addAll(moneyBox,10,5,20,50,100,200,500,800,2,80,300,700);</span><br><span class="line">        Lottery lottery&#x3D;new Lottery(moneyBox);</span><br><span class="line">        FutureTask&lt;Integer&gt; ft1&#x3D;new FutureTask&lt;&gt;(lottery);</span><br><span class="line">        FutureTask&lt;Integer&gt; ft2&#x3D;new FutureTask&lt;&gt;(lottery);</span><br><span class="line"></span><br><span class="line">        Thread t1&#x3D;new Thread(ft1);</span><br><span class="line">        Thread t2&#x3D;new Thread(ft2);</span><br><span class="line">        t1.setName(&quot;抽奖箱1&quot;);</span><br><span class="line">        t2.setName(&quot;抽奖箱2&quot;);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        int money;</span><br><span class="line">        String name;</span><br><span class="line">        if(ft1.get()&gt;ft2.get())&#123;</span><br><span class="line">            money&#x3D;ft1.get();</span><br><span class="line">            name&#x3D;t1.getName();</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            money&#x3D;ft2.get();</span><br><span class="line">            name&#x3D;t2.getName();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;在此次抽奖过程中，&quot;+name+&quot;产生最大值，最大值金额为&quot;+money);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">在此次抽奖过程中，抽奖箱1共产生6个奖项</span><br><span class="line">分别为:80,100,50,5,10,700最高奖项为700元，总计额为945元</span><br><span class="line">在此次抽奖过程中，抽奖箱2共产生6个奖项</span><br><span class="line">分别为:500,200,20,300,2,800最高奖项为800元，总计额为1822元</span><br><span class="line">在此次抽奖过程中，抽奖箱2产生最大值，最大值金额为800</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h2><h3 id="核心原理"><a href="#核心原理" class="headerlink" title="核心原理"></a>核心原理</h3><ol>
<li>创建一个池子，池子中是空的</li>
<li>提交任务时，池子会创建新的线程对象，执行完毕后，线程归还给池子，下次再提交任务时，不需创建新线程，直接复用已有的线程即可</li>
<li>若提交任务时，池子中没有空闲线程，也无法创建新的线程，任务便会排队等待</li>
</ol>
<p><strong>代码实现步骤</strong>：</p>
<ol>
<li>创建线程池</li>
<li>提交任务</li>
<li>所有的任务全部执行完毕，关闭线程池</li>
</ol>
<h3 id="Executors"><a href="#Executors" class="headerlink" title="Executors"></a>Executors</h3><p><strong>Executors</strong>：线程池的工具类通过调用方法返回不同类型的线程池对象。</p>
<h4 id="newCachedThreadPool"><a href="#newCachedThreadPool" class="headerlink" title="newCachedThreadPool"></a>newCachedThreadPool</h4><p><strong>格式</strong>：  </p>
<p>public static ExecutorsService newCachedThreadPool()  </p>
<p><strong>说明</strong>：创建一个几乎没有上限的线程池</p>
<h4 id="newFixedThreadPool"><a href="#newFixedThreadPool" class="headerlink" title="newFixedThreadPool"></a>newFixedThreadPool</h4><p><strong>格式</strong>：  </p>
<p>public static ExecutorsService newFixedThreadPool(int nThreads)  </p>
<p><strong>说明</strong>：创建一个有上限的线程池</p>
<h3 id="范例-3"><a href="#范例-3" class="headerlink" title="范例"></a>范例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">import java.util.concurrent.ExecutorService;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">    	&#x2F;&#x2F;1.获取线程池对象</span><br><span class="line">        ExecutorService pool&#x3D; Executors.newCachedThreadPool();</span><br><span class="line">        &#x2F;&#x2F;2.提交任务</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        &#x2F;&#x2F;3.销毁线程池</span><br><span class="line">        pool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;MyRunnable.java</span><br><span class="line">public class MyRunnable implements Runnable &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">pool-1-thread-1</span><br><span class="line">pool-1-thread-3</span><br><span class="line">pool-1-thread-5</span><br><span class="line">pool-1-thread-2</span><br><span class="line">pool-1-thread-4</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;MyRunnable.java</span><br><span class="line">public class MyRunnable implements Runnable &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">import java.util.concurrent.ExecutorService;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Test.java</span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">    	&#x2F;&#x2F;1.获取线程池对象</span><br><span class="line">        ExecutorService pool&#x3D; Executors.newFixedThreadPool(3);</span><br><span class="line">        &#x2F;&#x2F;2.提交任务</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        pool.submit(new MyRunnable());</span><br><span class="line">        &#x2F;&#x2F;3.销毁线程池</span><br><span class="line">        pool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">pool-1-thread-2</span><br><span class="line">pool-1-thread-1</span><br><span class="line">pool-1-thread-3</span><br><span class="line">pool-1-thread-1</span><br><span class="line">pool-1-thread-2</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="自定义线程"><a href="#自定义线程" class="headerlink" title="自定义线程"></a>自定义线程</h3><h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><ol>
<li><p>创建一个空的池子</p>
</li>
<li><p>有任务提交时，线程池会创建线程去执行任务，执行完毕归还线程。</p>
</li>
</ol>
<p><strong>注</strong>：不断提交任务，会有以下三个临界点</p>
<ol>
<li>当核心线程满时，在提交任务就会排队</li>
<li>当核心线程满，队满时，会创建临时线程</li>
<li>当核心线程满，队满时，临时线程满时，会触发任务拒绝策略</li>
</ol>
<h4 id="核心元素（参数）"><a href="#核心元素（参数）" class="headerlink" title="核心元素（参数）"></a>核心元素（参数）</h4><ol>
<li>核心线程数量（不少于0）</li>
<li>线程池中最大线程数量（最大数量&gt;=核心线程数量）</li>
<li>空闲时间（值）（不能小于0）</li>
<li>空闲时间（单位）（用TimeUnit绑定）</li>
<li>阻塞队列（不能为null）</li>
<li>创建线程工厂（不能为null）</li>
<li>要执行的任务过多时的解决方案（不能为null）</li>
</ol>
<h4 id="范例-4"><a href="#范例-4" class="headerlink" title="范例"></a>范例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line">import java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        ThreadPoolExecutor pool&#x3D;new ThreadPoolExecutor(</span><br><span class="line">                3,&#x2F;&#x2F;核心线程数量（不少于0）</span><br><span class="line">                6,&#x2F;&#x2F;线程池中最大线程数量（最大数量&gt;&#x3D;核心线程数量）</span><br><span class="line">                60,&#x2F;&#x2F;空闲时间（值）（不能小于0）</span><br><span class="line">                TimeUnit.SECONDS,&#x2F;&#x2F;空闲时间（单位）（用TimeUnit绑定）</span><br><span class="line">                new ArrayBlockingQueue&lt;&gt;(3),&#x2F;&#x2F;阻塞队列（不能为null）</span><br><span class="line">                Executors.defaultThreadFactory(),&#x2F;&#x2F;创建线程工厂（不能为null）</span><br><span class="line">                new ThreadPoolExecutor.AbortPolicy()&#x2F;&#x2F;要执行的任务过多时的解决方案（不能为null）</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="线程池多大合适"><a href="#线程池多大合适" class="headerlink" title="线程池多大合适"></a>线程池多大合适</h3><p><strong>最大并行数</strong>：可用Runtime.getRuntime().availableProcessors()返回当前电脑的最大并行数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CPU密集型运算：即项目中CPU计算居多，线程池大小&#x3D;最大并行数+1  </span><br><span class="line"></span><br><span class="line">I&#x2F;O密集型运算：即项目中文件操作居多，线程池大小&#x3D;最大并行数*期望CPU利用率*（总时间（CPU计算时间+等待时间）&#x2F;CPU计算时间）</span><br></pre></td></tr></table></figure>



                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">ljs</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2023/04/06/J19/">http://example.com/2023/04/06/J19/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="/about" target="_blank">ljs</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/JAVA/">
                                    <span class="chip bg-color">JAVA</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,wechat" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/loading.gif" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/loading.gif" data-original="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'f20c0190a7dc9f5254f1',
        clientSecret: '314c0f6b6ca0fc6867110ca87e1953b07d5eb064',
        repo: 'contact.github.io',
        owner: 'th-gs',
        admin: ["th-gs"],
        id: '2023-04-06T17-31-48',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2023/04/08/J20/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/loading.gif" data-original="/medias/featureimages/5.jpg" class="responsive-img" alt="网络编程（二十）">
                        
                        <span class="card-title">网络编程（二十）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            网络编程
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-04-08
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/notes/" class="post-category">
                                    notes
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JAVA/">
                        <span class="chip bg-color">JAVA</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/04/04/J18/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/loading.gif" data-original="/medias/featureimages/9.jpg" class="responsive-img" alt="IO流（十八）">
                        
                        <span class="card-title">IO流（十八）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            IO流
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-04-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/notes/" class="post-category">
                                    notes
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JAVA/">
                        <span class="chip bg-color">JAVA</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: ljs&#39;s blog<br />'
            + 'Author: ljs<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2023</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">ljs</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">154.4k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/th-gs" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1501903751@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1501903751" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1501903751" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}i(),n.addEventListener("scroll",function(){var t,e;t=i,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>

</html>
